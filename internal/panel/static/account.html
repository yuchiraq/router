<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Account - Router</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
<nav class="nav"><div class="nav-container"><a href="/account" class="nav-logo">Router</a><div class="nav-links"><a href="/">Home</a><a href="/stats">Stats</a><a href="/backups">Backups</a><a href="/notifications">Notifications</a><a href="/settings">GPT</a><a href="/account" class="active">Account</a></div></div></nav>
<main class="container">
<div class="header"><h1>Account Security</h1></div>
<div class="card"><div class="card-header">Change login and password</div><div class="card-body">
<div class="form-inline" style="margin-bottom:12px;"><input id="username" class="form-control" placeholder="Login"></div>
<div class="form-inline" style="margin-bottom:12px;"><input id="password" type="password" class="form-control" placeholder="New password (min 6)"></div>
<div class="form-inline"><button id="save-btn" class="btn">Save</button><button id="logout-btn" class="btn btn-danger">Logout</button></div>
<p id="status" style="margin-top:12px;color:var(--text-secondary);"></p>
</div></div>
</main>
<script>
(function(){
 function setStatus(t,e){var el=document.getElementById('status');el.textContent=t||'';el.style.color=e?'var(--accent-red)':'var(--text-secondary)';}
 fetch('/account/data',{credentials:'same-origin'}).then(r=>r.json()).then(function(d){document.getElementById('username').value=d.username||'';});
 document.getElementById('save-btn').addEventListener('click', function(){
  var b=new URLSearchParams(); b.set('username',document.getElementById('username').value.trim()); b.set('password',document.getElementById('password').value);
  fetch('/account/config',{method:'POST',credentials:'same-origin',headers:{'Content-Type':'application/x-www-form-urlencoded'},body:b.toString()})
   .then(function(r){if(!r.ok) return r.text().then(t=>{throw new Error(t||'failed')}); return r.json();})
   .then(function(){document.getElementById('password').value=''; setStatus('Saved.',false);})
   .catch(function(e){setStatus(e.message||String(e),true)});
 });
 document.getElementById('logout-btn').addEventListener('click', function(){
   fetch('/logout',{method:'POST',credentials:'same-origin'}).then(function(){location.href='/login';});
 });
})();
</script>
</body>
</html>
